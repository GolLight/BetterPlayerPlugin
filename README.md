# Better Web Player Extension (Better Player)

## ðŸŽ¥ é¡¹ç›®æ¦‚è¿°ï¼šWeb æ’­æ”¾å¢žå¼ºè„šæœ¬æ³¨å…¥æ¡†æž¶

**Better Web Player Extension** çš„æ ¸å¿ƒä»·å€¼åœ¨äºŽæä¾›ä¸€ä¸ª**çµæ´»ã€é€šç”¨çš„ JavaScript è„šæœ¬æ³¨å…¥æ¡†æž¶**ï¼Œä¸“é—¨ä¸º Jellyfin Web å®¢æˆ·ç«¯è®¾è®¡ã€‚

### æ ¸å¿ƒç›®çš„ä¸Žä»·å€¼

* **å½“å‰ç‰ˆæœ¬åŠŸèƒ½ (v1.x):** æ’ä»¶é»˜è®¤å†…ç½®å¹¶æ³¨å…¥äº†æ¡‚é¸¢åŽŸä½œè€…å¼€å‘çš„ä¼˜ç§€å‰ç«¯è„šæœ¬ `better_player.js`ï¼Œä¸ºç”¨æˆ·æä¾›å³æ—¶çš„æ’­æ”¾å™¨å¢žå¼ºä½“éªŒã€‚
* **æœªæ¥ç›®æ ‡ (v2.x+):** **å®žçŽ°è‡ªå®šä¹‰è„šæœ¬æ³¨å…¥åŠŸèƒ½ã€‚** æœ¬æ’ä»¶å°†å…è®¸ç”¨æˆ·é€šè¿‡è®¾ç½®ç•Œé¢ï¼ŒæŒ‡å®šä»»ä½•å¤–éƒ¨ JavaScript è„šæœ¬çš„ URLï¼Œå¹¶å°†å…¶å®‰å…¨ã€ç¨³å®šåœ°æ³¨å…¥åˆ° Jellyfin Web æ’­æ”¾é¡µé¢ä¸­ï¼Œä»¥å®žçŽ°é«˜åº¦ä¸ªæ€§åŒ–çš„æ’­æ”¾å™¨å¢žå¼ºã€‚

æœ¬æ’ä»¶é€šè¿‡ C# åŽç«¯é€»è¾‘ï¼Œåˆ©ç”¨ **File Transformation Plugin (FT æ’ä»¶)** æœºåˆ¶ï¼Œå®žçŽ°è„šæœ¬çš„å®‰å…¨ã€ç¨³å®šæ³¨å…¥ã€‚

### ðŸ¤– å¼€å‘è€…è¯´æ˜Ž

æœ¬é¡¹ç›®ç”± **GolLight** ç‹¬ç«‹å¼€å‘å’Œç»´æŠ¤ï¼Œå¹¶å…¨ç¨‹åˆ©ç”¨ **Google Gemini AI** å’Œ **VS Code Agent** è¿›è¡Œä»£ç ç”Ÿæˆã€æž¶æž„è®¾è®¡å’Œè°ƒè¯•è¾…åŠ©ã€‚

---

## ðŸ™ æ ¸å¿ƒåŠŸèƒ½æ¥æºä¸Žè‡´è°¢

æœ¬æ’ä»¶æ‰€å°è£…çš„æ ¸å¿ƒå‰ç«¯å¢žå¼ºé€»è¾‘ï¼ˆ`better_player.js`ï¼‰**å…¨éƒ¨** æ¥æºäºŽä»¥ä¸‹ä¼˜ç§€é¡¹ç›®ã€‚æœ¬æ’ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å‰ç«¯åŠŸèƒ½é€»è¾‘ï¼Œæ‰€æœ‰æ’­æ”¾å™¨å¢žå¼ºç‰¹æ€§å‡ç”±åŽŸè„šæœ¬æä¾›ã€‚

| å±žæ€§ | å†…å®¹ | é“¾æŽ¥ |
| :--- | :--- | :--- |
| **åŽŸä½œè€…** | **æ¡‚é¸¢ (guiyuanyuanbao)** | [https://github.com/guiyuanyuanbao/](https://github.com/guiyuanyuanbao/) |
| **åŽŸé¡¹ç›®ä»“åº“** | betterJellyfinWebPlayer-extension | [https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension](https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension) |
| **æ ¸å¿ƒè„šæœ¬æ–‡ä»¶** | `better_player.js` | [https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension/blob/main/batter_player.js](https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension/blob/main/batter_player.js) |

**è‡´è°¢ï¼š** æˆ‘ä»¬åœ¨æ­¤è¡·å¿ƒæ„Ÿè°¢åŽŸä½œè€… `æ¡‚é¸¢` æä¾›çš„ä¼˜ç§€å‰ç«¯è„šæœ¬ã€‚

### ðŸ‘ æ’ä»¶æ¨¡æ¿ä¸Žæž¶æž„å‚è€ƒè‡´è°¢

æœ¬æ’ä»¶çš„ **é¡¹ç›®ç»“æž„ã€C# æž¶æž„å’Œ File Transformation (FT) æ³¨å…¥æœºåˆ¶** å¤§é‡å‚è€ƒäº†ä»¥ä¸‹é¡¹ç›®ï¼Œåœ¨æ­¤è¡¨ç¤ºè¯šæŒšæ„Ÿè°¢ï¼š

* **é¡¹ç›®åç§°:** InPlayerEpisodePreview
* **ä»“åº“:** [https://github.com/Namo2/InPlayerEpisodePreview](https://github.com/Namo2/InPlayerEpisodePreview)
* **ä½œè€…:** Namo2

---

## âœ¨ æ’ä»¶ç‰¹æ€§ (åŠŸèƒ½ç”±é»˜è®¤æ³¨å…¥çš„ `better_player.js` æä¾›)

* å¢žå¼ºçš„é”®ç›˜å’Œè§¦æŽ§äº¤äº’ã€‚
* é¼ æ ‡æ‚¬åœæ—¶çš„ Trickplay é¢„è§ˆç¼©ç•¥å›¾ã€‚
* å…¶ä»–è‡ªå®šä¹‰æ’­æ”¾å™¨æ”¹è¿›ã€‚

---

## ðŸš€ å®‰è£…æ­¥éª¤

### âš ï¸ å…ˆå†³æ¡ä»¶

1.  Jellyfin æœåŠ¡å™¨ç‰ˆæœ¬ï¼š**10.11.0 æˆ–æ›´é«˜**ã€‚
2.  å¿…é¡»å®‰è£… **File Transformation Plugin (FT æ’ä»¶)**ï¼Œæœ¬æ’ä»¶ä¾èµ–å…¶æ³¨å…¥åŠŸèƒ½ã€‚
    > **FT æ’ä»¶é“¾æŽ¥:** [https://github.com/IAmParadox27/jellyfin-plugin-file-transformation](https://github.com/IAmParadox27/jellyfin-plugin-file-transformation)

### 1. æ·»åŠ è‡ªå®šä¹‰å­˜å‚¨åº“

åœ¨æ‚¨çš„ Jellyfin ç®¡ç†é¢æ¿ä¸­ï¼Œå¯¼èˆªåˆ° **æ’ä»¶** -> **å­˜å‚¨åº“**ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ URLï¼š

> **å­˜å‚¨åº“ URL (GitHub Raw Link)ï¼š**
>
> **`https://raw.githubusercontent.com/GolLight/BetterPlayerPlugin/master/manifest.json`**

### 2. å®Œæˆå®‰è£…

1.  å¯¼èˆªåˆ° **ç›®å½• (Catalog)** é€‰é¡¹å¡ã€‚
2.  æ‰¾åˆ°å¹¶å®‰è£… **"Better Player"** (æˆ– **"Better Web Player Extension"**ï¼Œå–å†³äºŽæ‚¨çš„ `manifest.json` é…ç½®)ã€‚
3.  å®‰è£…åŽï¼Œ**é‡å¯ Jellyfin æœåŠ¡å™¨** ä»¥ä½¿æ’ä»¶ç”Ÿæ•ˆã€‚

---

## âš™ï¸ æ ¸å¿ƒåŽŸç†æµç¨‹å›¾

è¯¥å›¾å±•ç¤ºäº†æ’ä»¶åœ¨ Jellyfin å¯åŠ¨æ—¶å¦‚ä½•æ³¨å†Œæ³¨å…¥ç‚¹ï¼Œä»¥åŠæµè§ˆå™¨å¦‚ä½•åŠ è½½è„šæœ¬çš„æœºåˆ¶ï¼š
```mermaid
graph TD
    subgraph S1 [Plugin Startup]
        A[StartupService Init] --> B{FT Plugin Installed?};
        
        B -- Yes --> C[Reflection Call: Register FileTransformer to FT];
        B -- No (Fallback) --> D[Direct Mode: Modify index.html];
        
        C --> E(Injection Point Established);
        D --> E;
    end
    
    subgraph S2 [Script Loading]
        F[User Accesses Web Player] --> G(Browser Requests index.html);
        
        G --> H{Server Response: Injected HTML};
        
        H --> I[HTML contains script tag: <br/>&lt;script src='/BetterPlayerPlugin/better_player.js'&gt;];
        
        I --> J[Browser Requests /better_player.js];
        
        J --> K[JsController API Intercepts];
        
        K --> L[Load Script from Plugin DLL Resources];
        
        L --> M(ðŸš€ Script Executes: Player Enhanced);
    end
    
    E --> F;

    style B fill:#FEEFB3,stroke:#CC9900;
    style E fill:#DDEEFF,stroke:#3C88A8,stroke-width:2px;
    style M fill:#E8F7DD,stroke:#6AA84F,font-weight:bold;
