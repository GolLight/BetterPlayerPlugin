# Better Web Player Extension (Better Player)

## ğŸ¥ é¡¹ç›®æ¦‚è¿°ï¼šWeb æ’­æ”¾å¢å¼ºè„šæœ¬æ³¨å…¥æ¡†æ¶

**Better Web Player Extension** çš„æ ¸å¿ƒä»·å€¼åœ¨äºæä¾›ä¸€ä¸ª**çµæ´»ã€é€šç”¨çš„ JavaScript è„šæœ¬æ³¨å…¥æ¡†æ¶**ï¼Œä¸“é—¨ä¸º Jellyfin Web å®¢æˆ·ç«¯è®¾è®¡ã€‚
ç›®å‰é€šè¿‡å†…ç½® `better_player.js`ï¼Œæä¾›ç±»ä¼¼ **B ç«™** çš„æ²‰æµ¸å¼æ’­æ”¾ä½“éªŒã€‚

### æ ¸å¿ƒç›®çš„ä¸ä»·å€¼

* **å½“å‰ç‰ˆæœ¬ (v1.x): ç¨³å®šåŠŸèƒ½éƒ¨ç½²ã€‚** æ’ä»¶é»˜è®¤å†…ç½®å¹¶æ³¨å…¥äº†æ¡‚é¸¢åŸä½œè€…å¼€å‘çš„ä¼˜ç§€å‰ç«¯è„šæœ¬ `better_player.js`ï¼Œä¸ºç”¨æˆ·æä¾›å³æ—¶çš„æ’­æ”¾å™¨å¢å¼ºä½“éªŒï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®è„šæœ¬ç®¡ç†å™¨ã€‚
* **æœªæ¥ç›®æ ‡ (v2.x+): é«˜åº¦è‡ªå®šä¹‰ã€‚** æœ¬æ’ä»¶å°†å…è®¸ç”¨æˆ·é€šè¿‡è®¾ç½®ç•Œé¢ï¼ŒæŒ‡å®šä»»ä½•å¤–éƒ¨ JavaScript è„šæœ¬çš„ URLï¼Œå¹¶å°†å…¶å®‰å…¨ã€ç¨³å®šåœ°æ³¨å…¥åˆ° Jellyfin Web æ’­æ”¾é¡µé¢ä¸­ï¼Œä»¥å®ç°é«˜åº¦ä¸ªæ€§åŒ–çš„æ’­æ”¾å™¨å¢å¼ºã€‚

æœ¬æ’ä»¶é€šè¿‡ C# åç«¯é€»è¾‘ï¼Œåˆ©ç”¨ **File Transformation Plugin (FT æ’ä»¶)** æœºåˆ¶ï¼Œå®ç°è„šæœ¬çš„å®‰å…¨ã€ç¨³å®šæ³¨å…¥ã€‚

### ğŸ¤– å¼€å‘è€…è¯´æ˜

æœ¬é¡¹ç›®ç”± **GolLight** ç‹¬ç«‹å¼€å‘å’Œç»´æŠ¤ï¼Œå¹¶å…¨ç¨‹åˆ©ç”¨ **Google Gemini AI**è¿›è¡Œä»£ç ç”Ÿæˆã€æ¶æ„è®¾è®¡å’Œè°ƒè¯•è¾…åŠ©ã€‚

---

## ğŸ§© æ”¯æŒçš„å®¢æˆ·ç«¯

| å®¢æˆ·ç«¯ | æ”¯æŒæƒ…å†µ | å¤‡æ³¨ |
| :--- | :--- | :--- |
| **Jellyfin Web** | âœ… å®Œæ•´åŠŸèƒ½æ”¯æŒ | åœ¨æ‰€æœ‰ä¸»æµæµè§ˆå™¨ä¸­é€šè¿‡ Web UI è®¿é—®ã€‚ |
| **Jellyfin Android** | âœ… ä½¿ç”¨ç½‘é¡µæ’­æ”¾å™¨æ—¶æ”¯æŒ | é€šå¸¸æŒ‡é€šè¿‡æµè§ˆå™¨æˆ–å†…ç½® WebView è®¿é—®ã€‚ |
| **Jellyfin iOS** | âš ï¸ å—æµè§ˆå™¨é™åˆ¶ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å®Œå…¨å¯ç”¨ | ä»…é™é€šè¿‡æµè§ˆå™¨æˆ–å†…ç½® WebView è®¿é—®ã€‚ |

---

## ğŸŒŸ æ ¸å¿ƒåŠŸèƒ½æ¦‚è§ˆ

æ‰€æœ‰ä»¥ä¸‹åŠŸèƒ½å‡ç”±é»˜è®¤æ³¨å…¥çš„ `better_player.js` è„šæœ¬æä¾›ï¼Œæ—¨åœ¨æä¾›**æ²‰æµ¸å¼**ã€**ç±»ä¼¼ B ç«™**çš„äº¤äº’ä½“éªŒï¼ŒåŒ…æ‹¬å¢å¼ºçš„é”®ç›˜å’Œè§¦æ§äº¤äº’ã€ä»¥åŠé¼ æ ‡æ‚¬åœæ—¶çš„ **Trickplay é¢„è§ˆç¼©ç•¥å›¾**ç­‰ã€‚

### ğŸ® æ¡Œé¢ç«¯æ§åˆ¶ (é”®ç›˜ / é¼ æ ‡)

| æ“ä½œ | æ•ˆæœæè¿° | å¤‡æ³¨ |
| :--- | :--- | :--- |
| **å³æ–¹å‘é”®çŸ­æŒ‰** | å¿«è¿› **10 ç§’** | ç²¾å‡†æ§åˆ¶ã€‚ |
| **å³æ–¹å‘é”®é•¿æŒ‰** | æŒ‰ä½æ—¶ **2Ã— å€é€Ÿæ’­æ”¾** | æ¾å¼€åè‡ªåŠ¨æ¢å¤æ­£å¸¸é€Ÿåº¦ã€‚ |
| **å€é€Ÿæç¤º** | è‡ªåŠ¨æ˜¾ç¤º | å€é€Ÿæ¿€æ´»æ—¶ï¼Œå±å¹•ä¸Šæ–¹æ˜¾ç¤ºé€Ÿåº¦æŒ‡ç¤ºå™¨ä¸**å‘¼å¸ç¯åŠ¨ç”»**ã€‚ |

### ğŸ“± ç§»åŠ¨ç«¯æ§åˆ¶ (è§¦æ§)

| æ“ä½œ | æ•ˆæœæè¿° | å¤‡æ³¨ |
| :--- | :--- | :--- |
| **åŒå‡»è§†é¢‘åŒºåŸŸ** | æ’­æ”¾ / æš‚åœ | å¿«é€Ÿæ§åˆ¶æ’­æ”¾çŠ¶æ€ã€‚ |
| **é•¿æŒ‰è§†é¢‘åŒºåŸŸ** | æŒ‰ä½æ—¶ **2Ã— å€é€Ÿæ’­æ”¾** | æ¾å¼€åè‡ªåŠ¨æ¢å¤ã€‚ |
| **æ°´å¹³æ»‘åŠ¨** | è°ƒèŠ‚æ’­æ”¾è¿›åº¦ | æ¯ **100 åƒç´ ** â‰ˆ **10 ç§’**ã€‚ |
| **æ»‘åŠ¨é¢„è§ˆ** | è‡ªåŠ¨æ˜¾ç¤º | æ»‘åŠ¨æ—¶æ˜¾ç¤ºæ—¶é—´é¢„è§ˆã€è‡ªå®šä¹‰è¿›åº¦æ¡ï¼Œè‹¥æœ‰é¢„è§ˆå›¾åˆ™åœ¨å·¦ä¸‹è§’æ˜¾ç¤ºç¼©ç•¥å›¾ã€‚ |

---

## ğŸš€ å®‰è£…æ­¥éª¤

### âš ï¸ å…ˆå†³æ¡ä»¶

1. Jellyfin æœåŠ¡å™¨ç‰ˆæœ¬ï¼š**10.11.0 æˆ–æ›´é«˜**ã€‚
2. å¿…é¡»å®‰è£… **File Transformation Plugin (FT æ’ä»¶)**ï¼Œæœ¬æ’ä»¶ä¾èµ–å…¶æ³¨å…¥åŠŸèƒ½ã€‚
    > **FT æ’ä»¶é“¾æ¥:** [https://github.com/IAmParadox27/jellyfin-plugin-file-transformation](https://github.com/IAmParadox27/jellyfin-plugin-file-transformation)

### 1. æ·»åŠ è‡ªå®šä¹‰å­˜å‚¨åº“

åœ¨æ‚¨çš„ Jellyfin ç®¡ç†é¢æ¿ä¸­ï¼Œå¯¼èˆªåˆ° **æ’ä»¶** -> **å­˜å‚¨åº“**ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ URLï¼š

> **å­˜å‚¨åº“ URL (GitHub Raw Link)ï¼š**
>
> **`https://raw.githubusercontent.com/GolLight/BetterPlayerPlugin/master/manifest.json`**

### 2. å®Œæˆå®‰è£…

1. å¯¼èˆªåˆ° **ç›®å½• (Catalog)** é€‰é¡¹å¡ã€‚
2. æ‰¾åˆ°å¹¶å®‰è£… **"Better Player"** ã€‚
3. å®‰è£…åï¼Œ**é‡å¯ Jellyfin æœåŠ¡å™¨** ä»¥ä½¿æ’ä»¶ç”Ÿæ•ˆã€‚

---

## ğŸ’» å¼€å‘è€…æŠ€æœ¯è¯¦æƒ…

### âš™ï¸ æ ¸å¿ƒåŸç†æµç¨‹å›¾

è¯¥å›¾å±•ç¤ºäº†æ’ä»¶åœ¨ Jellyfin å¯åŠ¨æ—¶å¦‚ä½•æ³¨å†Œæ³¨å…¥ç‚¹ï¼Œä»¥åŠæµè§ˆå™¨å¦‚ä½•åŠ è½½è„šæœ¬çš„æœºåˆ¶ï¼š

```mermaid
graph TD
    subgraph S1 [Plugin Startup]
        A[StartupService Init] --> B{FT Plugin Installed?};
        
        B -- Yes --> C[Reflection Call: Register FileTransformer to FT];
        B -- No (Fallback) --> D[Direct Mode: Modify index.html];
        
        C --> E(Injection Point Established);
        D --> E;
    end
    
    subgraph S2 [Script Loading]
        F[User Accesses Web Player] --> G(Browser Requests index.html);
        
        G --> H{Server Response: Injected HTML};
        
        H --> I[HTML contains script tag: <br/>&lt;script src='/BetterPlayerPlugin/better_player.js'&gt;];
        
        I --> J[Browser Requests /better_player.js];
        
        J --> K[JsController API Intercepts];
        
        K --> L[Load Script from Plugin DLL Resources];
        
        L --> M(ğŸš€ Script Executes: Player Enhanced);
    end
    
    E --> F;

    style B fill:#FEEFB3,stroke:#CC9900;
    style E fill:#DDEEFF,stroke:#3C88A8,stroke-width:2px;
    style M fill:#E8F7DD,stroke:#6AA84F,font-weight:bold;

```
### ğŸ“ é¡¹ç›®ç»“æ„æ¦‚è§ˆæ‰“åŒ…å‘½ä»¤ï¼ˆä»…æ„å»º DLLï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼‰
```Bash
dotnet build BetterPlayerPlugin/BetterPlayerPlugin.csproj --configuration Release
```

### ç›®å½•ç»“æ„
```Plaintext
BetterPlayerPlugin/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ release.yml        # (ä»£å®ç°) GitHub Actions è‡ªåŠ¨åŒ–å‘å¸ƒè„šæœ¬
â”œâ”€â”€ BetterPlayerPlugin/          # æ’ä»¶æ ¸å¿ƒä»£ç ç›®å½•
â”‚   â”œâ”€â”€ Controllers/             # API è·¯ç”±æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ Helpers/                 # HTML æ³¨å…¥é€»è¾‘æ ¸å¿ƒ
â”‚   â”œâ”€â”€ Providers/               # ä¾èµ–æ³¨å…¥æœåŠ¡æ³¨å†Œ
â”‚   â”œâ”€â”€ Resources/               # åµŒå…¥å¼èµ„æºæ–‡ä»¶ï¼ˆå¦‚ better_player.jsï¼‰
â”‚   â”œâ”€â”€ Services/                # å¯åŠ¨å’Œæ ¸å¿ƒæœåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ BetterPlayerPlugin.csproj #æ’ä»¶å·¥ç¨‹é…ç½® 
â”‚   â””â”€â”€ BetterPlayerPluginPlugin.cs  # æ’ä»¶ä¸»æ–‡ä»¶
â”œâ”€â”€ Images/
â”‚   â””â”€â”€ logo.png                 # geminiç”Ÿæˆçš„logo
â”œâ”€â”€ manifest.json                # æ’ä»¶å­˜å‚¨åº“æ¸…å•
â””â”€â”€ README.md                    # é¡¹ç›®è¯´æ˜æ–‡ä»¶
```
# ğŸ”§ å…³é”®æ–‡ä»¶ä¸ç›®å½•åŠŸèƒ½è¯´æ˜

| æ–‡ä»¶ / ç›®å½• | åŠŸèƒ½ | ç®€è¦è¯´æ˜ |
|--------------|------|----------|
| **BetterPlayerPluginPlugin.cs** | æ’ä»¶ä¸»å…¥å£ | å®šä¹‰æ’ä»¶åç§°ã€ID (GUID)ã€ç‰ˆæœ¬ç­‰åŸºæœ¬ä¿¡æ¯ã€‚ |
| **Services/StartupService.cs** | å¯åŠ¨é€»è¾‘ | åœ¨ Jellyfin å¯åŠ¨æ—¶æ‰§è¡Œï¼Œè´Ÿè´£æ£€æŸ¥ FT æ’ä»¶çŠ¶æ€å¹¶æ³¨å†Œ HTML æ³¨å…¥æœºåˆ¶ã€‚ |
| **Resources/better_player.js** | å‰ç«¯è„šæœ¬ | æ’ä»¶æ ¸å¿ƒåŠŸèƒ½çš„è½½ä½“ï¼Œä½œä¸ºåµŒå…¥èµ„æºåœ¨è¿è¡Œæ—¶æ³¨å…¥åˆ° Web æ’­æ”¾å™¨ä¸­ã€‚ |
| **Controllers/BetterPlayerJsController.cs** | API è·¯ç”± | å“åº”æµè§ˆå™¨å¯¹ `/better_player.js` çš„è¯·æ±‚ï¼Œæä¾›è„šæœ¬å†…å®¹ã€‚ |
| **Helpers/WebHtmlInjector.cs** | æ³¨å…¥æ ¸å¿ƒ | åŒ…å«ç”¨äºä¿®æ”¹æˆ–æ‹¦æˆª `index.html` çš„é€»è¾‘å®ç°ã€‚ |
| **manifest.json** | å­˜å‚¨åº“æ¸…å• | Jellyfin æ’ä»¶ç›®å½•ä½¿ç”¨çš„ JSON æ–‡ä»¶ï¼ŒåŒ…å«å‘å¸ƒç‰ˆæœ¬çš„ä¸‹è½½é“¾æ¥ä¸æ ¡éªŒä¿¡æ¯ã€‚ |

---

# ğŸ™ æ ¸å¿ƒåŠŸèƒ½æ¥æºä¸è‡´è°¢

### æ ¸å¿ƒè„šæœ¬è‡´è°¢

æœ¬æ’ä»¶å°è£…çš„æ ¸å¿ƒå‰ç«¯å¢å¼ºé€»è¾‘ï¼ˆ`better_player.js`ï¼‰å…¨éƒ¨æ¥æºäºä»¥ä¸‹ä¼˜ç§€é¡¹ç›®ã€‚  
æœ¬æ’ä»¶**ä¸åŒ…å«ä»»ä½•å‰ç«¯åŠŸèƒ½é€»è¾‘**ï¼Œæ‰€æœ‰æ’­æ”¾å™¨å¢å¼ºç‰¹æ€§å‡ç”±åŸè„šæœ¬æä¾›ã€‚

| å±æ€§ | å†…å®¹ |
|------|------|
| **åŸä½œè€…** | æ¡‚é¸¢ ([guiyuanyuanbao](https://github.com/guiyuanyuanbao)) |
| **åŸé¡¹ç›®ä»“åº“** | [betterJellyfinWebPlayer-extension](https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension) |
| **æ ¸å¿ƒè„šæœ¬æ–‡ä»¶** | [better_player.js](https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension/blob/main/batter_player.js) |

åœ¨æ­¤è¡·å¿ƒæ„Ÿè°¢åŸä½œè€… **æ¡‚é¸¢** æä¾›çš„ä¼˜ç§€å‰ç«¯è„šæœ¬ã€‚ğŸ‘

---

# ğŸ§© æ’ä»¶æ¨¡æ¿ä¸æ¶æ„å‚è€ƒè‡´è°¢

æœ¬æ’ä»¶çš„é¡¹ç›®ç»“æ„ã€C# æ¶æ„ä¸ File Transformation (FT) æ³¨å…¥æœºåˆ¶  
å¤§é‡å‚è€ƒäº†ä»¥ä¸‹é¡¹ç›®ï¼Œåœ¨æ­¤è¡¨ç¤ºè¯šæŒšæ„Ÿè°¢ï¼š

| é¡¹ç›®åç§° | ä»“åº“åœ°å€ | ä½œè€… |
|-----------|-----------|------|
| **InPlayerEpisodePreview** | [https://github.com/Namo2/InPlayerEpisodePreview](https://github.com/Namo2/InPlayerEpisodePreview) | Namo2 |

---

# ğŸ”— ç›¸å…³é“¾æ¥

- [Jellyfin å®˜ç½‘](https://jellyfin.org)

ğŸ’¡ **æç¤º**ï¼šå¦‚æœè§‰å¾—è¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ï¸ Star æ”¯æŒä¸€ä¸‹ï¼
