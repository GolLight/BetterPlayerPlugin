# Better Web Player Extension (Better Player)

## ğŸ¥ é¡¹ç›®æ¦‚è¿°ï¼šWeb æ’­æ”¾å¢å¼ºè„šæœ¬æ³¨å…¥æ¡†æ¶

**Better Web Player Extension** çš„æ ¸å¿ƒä»·å€¼åœ¨äºæä¾›ä¸€ä¸ª**çµæ´»ã€é€šç”¨çš„ JavaScript è„šæœ¬æ³¨å…¥æ¡†æ¶**ï¼Œä¸“é—¨ä¸º Jellyfin Web å®¢æˆ·ç«¯è®¾è®¡ã€‚

### æ ¸å¿ƒç›®çš„ä¸ä»·å€¼

* **å½“å‰ç‰ˆæœ¬åŠŸèƒ½ (v1.x):** æ’ä»¶é»˜è®¤å†…ç½®å¹¶æ³¨å…¥äº†æ¡‚é¸¢åŸä½œè€…å¼€å‘çš„ä¼˜ç§€å‰ç«¯è„šæœ¬ `better_player.js`ï¼Œä¸ºç”¨æˆ·æä¾›å³æ—¶çš„æ’­æ”¾å™¨å¢å¼ºä½“éªŒã€‚
* **æœªæ¥ç›®æ ‡ (v2.x+):** **å®ç°è‡ªå®šä¹‰è„šæœ¬æ³¨å…¥åŠŸèƒ½ã€‚** æœ¬æ’ä»¶å°†å…è®¸ç”¨æˆ·é€šè¿‡è®¾ç½®ç•Œé¢ï¼ŒæŒ‡å®šä»»ä½•å¤–éƒ¨ JavaScript è„šæœ¬çš„ URLï¼Œå¹¶å°†å…¶å®‰å…¨ã€ç¨³å®šåœ°æ³¨å…¥åˆ° Jellyfin Web æ’­æ”¾é¡µé¢ä¸­ï¼Œä»¥å®ç°é«˜åº¦ä¸ªæ€§åŒ–çš„æ’­æ”¾å™¨å¢å¼ºã€‚

æœ¬æ’ä»¶é€šè¿‡ C# åç«¯é€»è¾‘ï¼Œåˆ©ç”¨ **File Transformation Plugin (FT æ’ä»¶)** æœºåˆ¶ï¼Œå®ç°è„šæœ¬çš„å®‰å…¨ã€ç¨³å®šæ³¨å…¥ã€‚

### ğŸ¤– å¼€å‘è€…è¯´æ˜

æœ¬é¡¹ç›®ç”± **GolLight** ç‹¬ç«‹å¼€å‘å’Œç»´æŠ¤ï¼Œå¹¶å…¨ç¨‹åˆ©ç”¨ **Google Gemini AI** å’Œ **VS Code Agent** è¿›è¡Œä»£ç ç”Ÿæˆã€æ¶æ„è®¾è®¡å’Œè°ƒè¯•è¾…åŠ©ã€‚

---

## ğŸ™ æ ¸å¿ƒåŠŸèƒ½æ¥æºä¸è‡´è°¢

æœ¬æ’ä»¶æ‰€å°è£…çš„æ ¸å¿ƒå‰ç«¯å¢å¼ºé€»è¾‘ï¼ˆ`better_player.js`ï¼‰**å…¨éƒ¨** æ¥æºäºä»¥ä¸‹ä¼˜ç§€é¡¹ç›®ã€‚æœ¬æ’ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å‰ç«¯åŠŸèƒ½é€»è¾‘ï¼Œæ‰€æœ‰æ’­æ”¾å™¨å¢å¼ºç‰¹æ€§å‡ç”±åŸè„šæœ¬æä¾›ã€‚

| å±æ€§ | å†…å®¹ | é“¾æ¥ |
| :--- | :--- | :--- |
| **åŸä½œè€…** | **æ¡‚é¸¢ (guiyuanyuanbao)** | [https://github.com/guiyuanyuanbao/](https://github.com/guiyuanyuanbao/) |
| **åŸé¡¹ç›®ä»“åº“** | betterJellyfinWebPlayer-extension | [https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension](https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension) |
| **æ ¸å¿ƒè„šæœ¬æ–‡ä»¶** | `better_player.js` | [https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension/blob/main/batter_player.js](https://github.com/guiyuanyuanbao/Jellyfin-betterJellyfinWebPlayer-extension/blob/main/batter_player.js) |

**è‡´è°¢ï¼š** æˆ‘ä»¬åœ¨æ­¤è¡·å¿ƒæ„Ÿè°¢åŸä½œè€… `æ¡‚é¸¢` æä¾›çš„ä¼˜ç§€å‰ç«¯è„šæœ¬ã€‚

### ğŸ‘ æ’ä»¶æ¨¡æ¿ä¸æ¶æ„å‚è€ƒè‡´è°¢

æœ¬æ’ä»¶çš„ **é¡¹ç›®ç»“æ„ã€C# æ¶æ„å’Œ File Transformation (FT) æ³¨å…¥æœºåˆ¶** å¤§é‡å‚è€ƒäº†ä»¥ä¸‹é¡¹ç›®ï¼Œåœ¨æ­¤è¡¨ç¤ºè¯šæŒšæ„Ÿè°¢ï¼š

* **é¡¹ç›®åç§°:** InPlayerEpisodePreview
* **ä»“åº“:** [https://github.com/Namo2/InPlayerEpisodePreview](https://github.com/Namo2/InPlayerEpisodePreview)
* **ä½œè€…:** Namo2

---

## âœ¨ æ’ä»¶ç‰¹æ€§ (åŠŸèƒ½ç”±é»˜è®¤æ³¨å…¥çš„ `better_player.js` æä¾›)

* å¢å¼ºçš„é”®ç›˜å’Œè§¦æ§äº¤äº’ã€‚
* é¼ æ ‡æ‚¬åœæ—¶çš„ Trickplay é¢„è§ˆç¼©ç•¥å›¾ã€‚
* å…¶ä»–è‡ªå®šä¹‰æ’­æ”¾å™¨æ”¹è¿›ã€‚

---

## ğŸš€ å®‰è£…æ­¥éª¤

### âš ï¸ å…ˆå†³æ¡ä»¶

1.  Jellyfin æœåŠ¡å™¨ç‰ˆæœ¬ï¼š**10.11.0 æˆ–æ›´é«˜**ã€‚
2.  å¿…é¡»å®‰è£… **File Transformation Plugin (FT æ’ä»¶)**ï¼Œæœ¬æ’ä»¶ä¾èµ–å…¶æ³¨å…¥åŠŸèƒ½ã€‚
    > **FT æ’ä»¶é“¾æ¥:** [https://github.com/IAmParadox27/jellyfin-plugin-file-transformation](https://github.com/IAmParadox27/jellyfin-plugin-file-transformation)

### 1. æ·»åŠ è‡ªå®šä¹‰å­˜å‚¨åº“

åœ¨æ‚¨çš„ Jellyfin ç®¡ç†é¢æ¿ä¸­ï¼Œå¯¼èˆªåˆ° **æ’ä»¶** -> **å­˜å‚¨åº“**ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ URLï¼š

> **å­˜å‚¨åº“ URL (GitHub Raw Link)ï¼š**
>
> **`https://raw.githubusercontent.com/GolLight/BetterPlayerPlugin/master/manifest.json`**

### 2. å®Œæˆå®‰è£…

1.  å¯¼èˆªåˆ° **ç›®å½• (Catalog)** é€‰é¡¹å¡ã€‚
2.  æ‰¾åˆ°å¹¶å®‰è£… **"Better Player"** (æˆ– **"Better Web Player Extension"**ï¼Œå–å†³äºæ‚¨çš„ `manifest.json` é…ç½®)ã€‚
3.  å®‰è£…åï¼Œ**é‡å¯ Jellyfin æœåŠ¡å™¨** ä»¥ä½¿æ’ä»¶ç”Ÿæ•ˆã€‚

---

## âš™ï¸ æ ¸å¿ƒåŸç†æµç¨‹å›¾

è¯¥å›¾å±•ç¤ºäº†æ’ä»¶åœ¨ Jellyfin å¯åŠ¨æ—¶å¦‚ä½•æ³¨å†Œæ³¨å…¥ç‚¹ï¼Œä»¥åŠæµè§ˆå™¨å¦‚ä½•åŠ è½½è„šæœ¬çš„æœºåˆ¶ï¼š
```mermaid
graph TD
    subgraph å¯åŠ¨ä¸æ³¨å†Œ (Jellyfin Server Boot)
        A[StartupService å¯åŠ¨] --> B{FT æ’ä»¶å·²å®‰è£…?};
        
        B -- æ˜¯ --> C[åå°„è°ƒç”¨: FT æ’ä»¶æ³¨å†Œ WebHtmlInjector.FileTransformer];
        B -- å¦ (é™çº§) --> D[WebHtmlInjector.Direct()ï¼šç›´æ¥ä¿®æ”¹ index.html];
        
        C --> E(æ³¨å…¥ç‚¹ï¼šé€šè¿‡ FT æ‹¦æˆªæœºåˆ¶å»ºç«‹);
        D --> E;
    end
    
    subgraph è„šæœ¬åˆ†å‘ä¸åŠ è½½ (Browser Access)
        F[ç”¨æˆ·åœ¨æµè§ˆå™¨è®¿é—® Web æ’­æ”¾å™¨] --> G(æµè§ˆå™¨è¯·æ±‚ index.html);
        
        G --> H{æœåŠ¡å™¨å“åº”: HTML æ–‡ä»¶è¢«æ³¨å…¥};
        
        H --> I[HTML åŒ…å«è„šæœ¬æ ‡ç­¾: <script src='/BetterPlayerPlugin/better_player.js'>];
        
        I --> J[æµè§ˆå™¨è¯·æ±‚: GET /BetterPlayerPlugin/better_player.js];
        
        J --> K[BetterPlayerJsController (API) æ‹¦æˆªè¯·æ±‚];
        
        K --> L[ä»æ’ä»¶ DLL (Resources) åŠ è½½ better_player.js];
        
        L --> M(ğŸš€ è„šæœ¬æ‰§è¡Œï¼šæ’­æ”¾å™¨å¢å¼ºå®Œæˆ);
    end
    
    A --> F;

    style B fill:#FEEFB3,stroke:#CC9900;
    style E fill:#DDEEFF,stroke:#3C88A8,stroke-width:2px;
    style M fill:#E8F7DD,stroke:#6AA84F,font-weight:bold;